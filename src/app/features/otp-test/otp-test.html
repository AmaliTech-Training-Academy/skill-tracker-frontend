<div class="otp-container">
  <div class="otp-card">
    <header class="card-header">
      <h2>Email Verification</h2>
    </header>

    <div class="card-content">
      <p class="instruction">
        We've sent a 6-digit verification code to your email. Please enter it below to complete registration.
      </p>

      @if (generalError()) {
        <p class="error-box">{{ generalError() }}</p>
      }

      @if (!sessionId) {
        <p class="error-box fatal">Session data missing. Please start registration again.</p>
        <button [routerLink]="['/signup']" class="btn primary">Go to Registration</button>
      } @else {
        <form [formGroup]="otpForm" (ngSubmit)="onSubmit()">
          
          <div class="form-group full-width">
            <label for="otp-input">Verification Code</label>
            <input 
              id="otp-input"
              type="text" 
              formControlName="otp" 
              placeholder="Enter 6-digit code" 
              inputmode="numeric"
              class="form-control"
              [disabled]="isLoading()"
            >
            
            @if (otp?.touched && otp?.errors) {
              @if (otp?.hasError('required')) {
                <p class="error-message">Code is required.</p>
              }
              @if (otp?.hasError('minlength') || otp?.hasError('maxlength')) {
                <p class="error-message">Code must be exactly 6 digits long.</p>
              }
              @if (otp?.hasError('pattern')) {
                <p class="error-message">Only numbers are allowed.</p>
              }
            }
          </div>

          <button 
            type="submit" 
            [disabled]="otpForm.invalid || isLoading()"
            class="submit-button full-width"
          >
            @if (!isLoading()) {
              <span>Verify and Continue</span>
            } @else {
              <span class="loading-indicator">Verifying...</span>
            }
          </button>
        </form>
      }
    </div>

    <div class="card-actions">
      Didn't receive the code? <a href="#">Resend Code</a>
    </div>
  </div>
</div>